# ===========================================
# Hypothesis Arena - Configuration
# ===========================================

# Server
NODE_ENV=development
PORT=25655
LOG_LEVEL=info

# ===========================================
# Database
# ===========================================
# Local SQLite (used by Prisma CLI for schema management)
DATABASE_URL="file:./dev.db"

# Turso (used in production runtime)
TURSO_DATABASE_URL="libsql://your-database.turso.io"
TURSO_AUTH_TOKEN="your_turso_auth_token_here"

# ===========================================
# WEEX API (Live Trading)
# ===========================================
# Get credentials from: https://www.weex.com/api
WEEX_API_KEY=
WEEX_SECRET_KEY=
WEEX_PASSPHRASE=
WEEX_BASE_URL=https://api-contract.weex.com
WEEX_WS_URL=wss://ws-contract.weex.com/v2/ws

# ===========================================
# AI Services
# ===========================================
# AI Provider: gemini or openrouter (default: gemini)
AI_PROVIDER=gemini

# Google Gemini API - Get key from: https://aistudio.google.com/apikey
GEMINI_API_KEY=

# OpenRouter API - Get key from: https://openrouter.ai/keys
OPENROUTER_API_KEY=

# OpenRouter Model (default: deepseek/deepseek-chat-v3.1)
# Other options: anthropic/claude-3.5-sonnet, qwen/qwen-2.5-72b-instruct, google/gemini-2.0-flash-exp:free
OPENROUTER_MODEL=deepseek/deepseek-chat-v3.1

# ===========================================
# Trading Configuration
# ===========================================
MAX_POSITION_SIZE=0.2
MAX_TOTAL_INVESTED=0.8
DRAWDOWN_PAUSE_THRESHOLD=0.3
DRAWDOWN_LIQUIDATE_THRESHOLD=0.8
MAX_LEVERAGE=10

# ===========================================
# Autonomous Trading Engine
# ===========================================
CYCLE_INTERVAL_MS=600000
MIN_TRADE_INTERVAL_MS=900000
DEBATE_FREQUENCY=3
MAX_POSITION_SIZE_PERCENT=30
MIN_BALANCE_TO_TRADE=10
DEFAULT_LEVERAGE=5
# Stop loss tolerance (5-15% recommended)
# IMPORTANT: 10% is 2x the previous 5% default - verify this is intentional for your risk tolerance
# Conservative: 5-7%, Moderate: 8-10%, Aggressive: 12-15%
STOP_LOSS_PERCENT=10
TAKE_PROFIT_PERCENT=10
MIN_CONFIDENCE_TO_TRADE=60
MIN_CONSENSUS_TO_TRADE=2
MAX_RETRIES=3
DRY_RUN=false

# Risk Management Limits
# IMPORTANT: These are aggressive defaults - review and adjust based on your risk tolerance
# NOTE: All *_PERCENT values use INTEGER percentages (e.g., 40 = 40%, not 0.40)
# Conservative = lower values, Aggressive = higher values
#
# PARAMETER INTERDEPENDENCIES:
# - MAX_SAME_DIRECTION_POSITIONS must be <= MAX_CONCURRENT_POSITIONS
# - MAX_CONCURRENT_RISK_PERCENT should be >= MAX_RISK_PER_TRADE_PERCENT × MAX_CONCURRENT_POSITIONS
#   Current: 6% >= 2% × 3 = 6% ✓ (exactly at limit)
# - NET_EXPOSURE_*_PERCENT × DEFAULT_LEVERAGE = actual market exposure (e.g., 60% × 5x = 300%)
# - WEEKLY_DRAWDOWN_LIMIT_PERCENT should trigger before DRAWDOWN_LIQUIDATE_THRESHOLD (80%)

MAX_CONCURRENT_POSITIONS=3           # Max total open positions at once (1-5 recommended). Conservative: 2-3, Aggressive: 4-5
MAX_SAME_DIRECTION_POSITIONS=2       # Max positions in same direction (LONG or SHORT). Must be <= MAX_CONCURRENT_POSITIONS. Conservative: 1-2, Aggressive: 3-4. Limits directional risk.
MAX_RISK_PER_TRADE_PERCENT=2         # Max account % risked per single trade (1-5). Conservative: 1-2%, Aggressive: 3-5%. Based on stop loss distance × position size.
MAX_CONCURRENT_RISK_PERCENT=6        # Max total account % at risk across all positions (3-10). Conservative: 3-5%, Aggressive: 8-10%. Sum of all position risks. Must be >= MAX_RISK_PER_TRADE × MAX_CONCURRENT_POSITIONS.
NET_EXPOSURE_LONG_PERCENT=60         # Max net LONG exposure as % of portfolio (margin used, not notional). Conservative: 40-50%, Aggressive: 60-80%. With 5x leverage, 60% margin = 300% notional.
NET_EXPOSURE_SHORT_PERCENT=50        # Max net SHORT exposure as % of portfolio (margin used, not notional). Conservative: 30-40%, Aggressive: 50-70%. Typically lower than LONG due to unlimited downside risk.
MAX_FUNDING_AGAINST_PERCENT=5        # Max funding rate against position per 8h period (integer %). Conservative: 3-5%, Aggressive: 8-10%. High funding drains profits over time.
WEEKLY_DRAWDOWN_LIMIT_PERCENT=10     # Max portfolio drawdown per week before reducing risk (5-20). Conservative: 5-10%, Aggressive: 15-20%. Triggers position size reduction.

# ===========================================
# Compliance
# ===========================================
REQUIRE_AI_LOGS=true

# ===========================================
# CORS
# ===========================================
CORS_ORIGINS=http://localhost:25655,http://localhost:3000

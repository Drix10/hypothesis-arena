# =============================================================================
# Core
# =============================================================================
PORT=3000
NODE_ENV=development
LOG_LEVEL=info
CORS_ORIGINS=http://localhost:3000,http://localhost:25655

# =============================================================================
# Database
# =============================================================================
DATABASE_URL=file:./dev.db
TURSO_DATABASE_URL=libsql://your-db-name.aws-us-east-1.turso.io
TURSO_AUTH_TOKEN=your_turso_auth_token_here

# =============================================================================
# WEEX (Exchange)
# =============================================================================
WEEX_API_KEY=your_weex_api_key_here
WEEX_SECRET_KEY=your_weex_secret_key_here
WEEX_PASSPHRASE=your_weex_passphrase_here
WEEX_ACCOUNT_TYPE=demo
WEEX_BASE_URL=https://api-contract.weex.com
WEEX_WS_URL=wss://ws-contract.weex.com/v2/ws
DEBUG_WEEX=false

# =============================================================================
# Competition Mode (safety-gated)
# =============================================================================
COMPETITION_MODE=false
COMPETITION_MODE_ACK=I_ACCEPT_DEMO_ONLY_RISK_MANAGED_SETTINGS

# =============================================================================
# AI Provider
# =============================================================================
AI_PROVIDER=openrouter
AI_MAX_OUTPUT_TOKENS=65536
AI_TEMPERATURE=0.7
# If AI_MAX_OUTPUT_TOKENS is large, increase timeout to avoid truncation/timeouts on big responses.
# Rule of thumb: timeout_ms â‰ˆ (max_tokens / 150 tokens_per_sec) * 1000 (adjust for your provider/model).
AI_REQUEST_TIMEOUT_MS=450000
AI_MAX_RETRIES=3
AI_THINKING_ENABLED=false
AI_THINKING_BUDGET=16000

GEMINI_API_KEY=your_gemini_api_key_here
GEMINI_MODEL=gemini-2.0-flash

OPENROUTER_API_KEY=your_openrouter_api_key_here
OPENROUTER_MODEL=deepseek/deepseek-chat

AI_HYBRID_MODE=false
ANALYST_JIM_PROVIDER=openrouter
ANALYST_RAY_PROVIDER=openrouter
ANALYST_KAREN_PROVIDER=gemini
ANALYST_QUANT_PROVIDER=gemini
JUDGE_PROVIDER=gemini

# =============================================================================
# Trading
# =============================================================================
STARTING_BALANCE=1000
MAX_DAILY_TRADES=20
DRY_RUN=true

# =============================================================================
# Autonomous Engine - timing & risk
# =============================================================================
CYCLE_INTERVAL_MS=300000
MIN_BALANCE_TO_TRADE=200
MAX_CONCURRENT_POSITIONS=3
MAX_SAME_DIRECTION_POSITIONS=2
WEEKLY_DRAWDOWN_LIMIT_PERCENT=10
MAX_RETRIES=3

# =============================================================================
# Confidence thresholds (0-100)
# =============================================================================
# Safer default: higher threshold reduces low-quality trades (especially important when DRY_RUN=false / production).
# For dev/demo experimentation you can lower this, but do so intentionally and understand it increases risk exposure.
MIN_CONFIDENCE_TO_TRADE=75
MODERATE_CONFIDENCE_THRESHOLD=60
HIGH_CONFIDENCE_THRESHOLD=70
VERY_HIGH_CONFIDENCE_THRESHOLD=80

# =============================================================================
# Position sizing (% of starting balance) and deployment (% of capital)
# =============================================================================
MIN_POSITION_PERCENT=10
TARGET_POSITION_MIN_PERCENT=12
TARGET_POSITION_MAX_PERCENT=15
MAX_POSITION_PERCENT=20
TARGET_DEPLOYMENT_PERCENT=50
MAX_DEPLOYMENT_PERCENT=60

# =============================================================================
# Position urgency thresholds
# =============================================================================
TARGET_PROFIT_PCT=5
STOP_LOSS_PCT=2.5
MAX_HOLD_HOURS=72
PARTIAL_TP_PCT=3
STALE_POSITION_HOURS=6
STALE_PNL_THRESHOLD=1.0

# =============================================================================
# Monte Carlo validation thresholds
# =============================================================================
MC_MIN_SHARPE_RATIO=1.5
MC_TARGET_SHARPE_RATIO=2.0
MC_EXCELLENT_SHARPE_RATIO=2.5
MC_MIN_WIN_RATE=0.55
MC_MAX_DRAWDOWN_PERCENT=25

# =============================================================================
# RL thresholds
# =============================================================================
Q_VALUE_MINIMUM=0.5
Q_VALUE_CONSENSUS=0.6
Q_VALUE_HIGH_CONFIDENCE=0.8

# =============================================================================
# Leverage scaling by exposure
# =============================================================================
LEVERAGE_SCALE_40PCT_MULT=0.82
LEVERAGE_SCALE_50PCT_MULT=0.70

# =============================================================================
# Global risk limits
# =============================================================================
AUTO_APPROVE_LEVERAGE_THRESHOLD=10
MAX_SAFE_LEVERAGE=15
ABSOLUTE_MAX_LEVERAGE=20
MAX_POSITION_SIZE_PERCENT=25
MAX_TOTAL_LEVERAGED_CAPITAL_PERCENT=40
MAX_RISK_PER_TRADE_PERCENT=5
MAX_CONCURRENT_RISK_PERCENT=15

# =============================================================================
# Correlation
# =============================================================================
ENABLE_CORRELATION_CHECKS=true
HIGH_CORRELATION_THRESHOLD=0.8
MAX_CORRELATED_POSITIONS=2
BTC_CORRELATION_WARNING=0.85

# =============================================================================
# Circuit breakers
# =============================================================================
CIRCUIT_YELLOW_BTC_DROP_4H=12
CIRCUIT_YELLOW_DRAWDOWN_24H=15
CIRCUIT_RED_BTC_DROP_4H=20
CIRCUIT_RED_DRAWDOWN_24H=30

# =============================================================================
# Stop loss tiers by leverage
# =============================================================================
SL_LOW_MAX_LEVERAGE=5
SL_LOW_MAX_STOP_PERCENT=6
SL_MEDIUM_MAX_LEVERAGE=10
SL_MEDIUM_MAX_STOP_PERCENT=3
SL_HIGH_MAX_LEVERAGE=15
SL_HIGH_MAX_STOP_PERCENT=3
SL_EXTREME_MAX_LEVERAGE=20
SL_EXTREME_MAX_STOP_PERCENT=2.5

# =============================================================================
# Risk Council
# =============================================================================
MAX_FUNDING_AGAINST_PERCENT=0.001
MAX_SECTOR_POSITIONS=3
NET_EXPOSURE_LIMIT_LONG=70
NET_EXPOSURE_LIMIT_SHORT=70

# =============================================================================
# Indicators
# =============================================================================
INDICATOR_CACHE_TTL_MS=60000

# =============================================================================
# Anti-Churn
# =============================================================================
COOLDOWN_AFTER_TRADE_MS=900000
COOLDOWN_BEFORE_FLIP_MS=1800000
MAX_TRADES_PER_SYMBOL_PER_HOUR=3
HYSTERESIS_MULTIPLIER=1.2
FUNDING_PERIODS_PER_DAY=3

# =============================================================================
# Production tuning
# =============================================================================
MC_TRADING_COST_PCT=0.06
MC_FUNDING_COST_PCT=0.01
MC_STUDENT_T_DF=3
MC_GARCH_ALPHA=0.1
MC_GARCH_BETA=0.85
MC_TRADES_PER_YEAR=750

REGIME_HISTORY_MAX=20
REGIME_HISTORY_MAX_SYMBOLS=50
REGIME_CLEANUP_INTERVAL_MS=600000
REGIME_MAX_AGE_MS=86400000

QUANT_CACHE_TTL_MS=300000
QUANT_MAX_CACHE_SIZE=100
FUNDING_HISTORY_MAX_ENTRIES=21
FUNDING_HISTORY_MAX_AGE_MS=604800000
FUNDING_HISTORY_MAX_SYMBOLS=50

SENTIMENT_NEWS_CACHE_TTL_MS=1800000
SENTIMENT_FEAR_GREED_CACHE_TTL_MS=3600000
SENTIMENT_MAX_CACHE_SIZE=100
SENTIMENT_REQUEST_TIMEOUT_MS=10000
SENTIMENT_MIN_FETCH_INTERVAL_MS=300000
SENTIMENT_BTC_WEIGHT=0.6
SENTIMENT_ETH_WEIGHT=0.4

REDDIT_CACHE_TTL_MS=1800000
REDDIT_REQUEST_DELAY_MS=2500
REDDIT_REQUEST_TIMEOUT_MS=10000
REDDIT_STALE_THRESHOLD_MS=1200000
REDDIT_MAX_POST_AGE_HOURS=24
REDDIT_MAX_CACHE_SIZE=50

POSITION_MAX_TRACKED_TRADES=100
POSITION_STALE_TRADE_HOURS=72
POSITION_OUTCOME_THRESHOLD_PCT=1.0
POSITION_MISSING_CYCLE_THRESHOLD=3

PORTFOLIO_RECENT_TRADES_LIMIT=10
PORTFOLIO_LOCK_TIMEOUT_MS=30000
PORTFOLIO_MAX_RETRIES=2
PORTFOLIO_RETRY_DELAY_MS=1000

WEEX_REQUEST_TIMEOUT_MS=120000
WEEX_RATE_LIMIT_MAX_ATTEMPTS=20
WEEX_RATE_LIMIT_MAX_WAIT_MS=60000

# =============================================================================
# News & Sentiment (optional)
# =============================================================================
NEWSDATA_API_KEY=your_newsdata_api_key_here
REDDIT_SENTIMENT_ENABLED=true
REDDIT_USER_AGENT=HypothesisArena/5.x (trading bot, respectful)

# =============================================================================
# Admin endpoints
# =============================================================================
AUTONOMOUS_ADMIN_ENABLED=false
AUTONOMOUS_ADMIN_TOKEN=your_admin_token_here_make_it_32_chars_minimum

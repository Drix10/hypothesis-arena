# Hypothesis Arena v5.4.0 (WINNER EDITION)

NODE_ENV=development
PORT=25655
LOG_LEVEL=info

# Database
DATABASE_URL="file:./dev.db"
# TURSO_DATABASE_URL="libsql://your-db.turso.io"
# TURSO_AUTH_TOKEN="your-token"

# WEEX API
WEEX_API_KEY=your_api_key
WEEX_SECRET_KEY=your_secret_key
WEEX_PASSPHRASE=your_passphrase
WEEX_BASE_URL=https://api-contract.weex.com
WEEX_WS_URL=wss://ws-contract.weex.com/v2/ws

# AI Provider Configuration
# Set AI_PROVIDER to choose which AI service to use:
#   - "gemini": Use Google Gemini (requires GEMINI_API_KEY)
#   - "openrouter": Use OpenRouter (requires OPENROUTER_API_KEY and OPENROUTER_MODEL)
AI_PROVIDER=openrouter

# Required when AI_PROVIDER=gemini
# GEMINI_API_KEY=your_gemini_api_key

# Required when AI_PROVIDER=openrouter
OPENROUTER_API_KEY=your_openrouter_api_key
OPENROUTER_MODEL=deepseek/deepseek-chat

# =============================================================================
# MULTI-MODEL ROTATION (v5.3.0)
# =============================================================================
# When enabled, each of the 4 analysts uses a different AI model per cycle.
# This provides diversity in analysis approaches and reduces single-model bias.
#
# Model Pool (randomly assigned each cycle):
#   - deepseek/deepseek-chat (strong reasoning, reliable - primary fallback)
#   - google/gemini-3-flash-preview (fast, reliable)
#   - x-ai/grok-4.1-fast (fast reasoning)
#   - xiaomi/mimo-v2-flash:free (reliable, fast)
#
# Set to false to use single model (OPENROUTER_MODEL) for all analysts
MULTI_MODEL_ENABLED=true

# Optional AI tuning parameters (advanced users only)
# AI_TEMPERATURE=0.7
# AI_MAX_OUTPUT_TOKENS=8192
# AI_REQUEST_TIMEOUT_MS=60000
# AI_MAX_RETRIES=3

# =============================================================================
# TRADING MODE CONFIGURATION (WINNER EDITION v5.4.0)
# =============================================================================
# COMPETITION_MODE: Enable aggressive risk settings for demo money competitions
#   false = Production-safe defaults (conservative: 10x max leverage, 25% max position)
#           Production mode prioritizes capital preservation over aggressive returns.
#   true  = Competition settings (17x max leverage, 50% max position)
#           Competition mode uses the "winning formula" below for demo competitions.
#
# COMPETITION MODE OBSERVATIONS (applies ONLY when COMPETITION_MODE=true):
#   Historical observation: Some past participants used 2-3 trades out of 5,
#   with 10-18% position sizes at 15-17x leverage. Others used larger positions
#   at higher leverage and experienced significant drawdowns.
#
#   DISCLAIMER: Past observations are not predictive of future results. These
#   figures are illustrative examples only and do not constitute trading advice.
#   You should develop your own risk management strategy tailored to your
#   individual risk tolerance. Position sizing and leverage decisions should be
#   based on your own analysis and risk assessment.
#
# ⚠️ CRITICAL WARNING: COMPETITION_MODE is for DEMO/PAPER TRADING ONLY!
# NEVER enable with real funds. The WEEX API does NOT provide a way to automatically
# detect whether an account is demo or live. YOU must explicitly set WEEX_ACCOUNT_TYPE
# to indicate your account type. Runtime protections rely on this user-provided value.
#
# RUNTIME PROTECTIONS:
# 1. Startup validation: System FAILS FAST if COMPETITION_MODE=true but WEEX_ACCOUNT_TYPE
#    is missing or set to "live" (no legacy warn-but-allow behavior)
# 2. Account type check: WEEX_ACCOUNT_TYPE must be "demo" or "test" for competition mode
# 3. Acknowledgment check: COMPETITION_MODE_ACK must exactly match the required string
# 4. Trade execution guard: Each trade logs a competition mode warning
# 5. Circuit breaker: Trading pauses if balance drops >30% within 1 hour (any mode)
#
# ALL THREE must be correctly set to enable aggressive settings:
# - COMPETITION_MODE=true
# - COMPETITION_MODE_ACK=I_ACCEPT_DEMO_ONLY_HIGH_RISK_AGGRESSIVE_SETTINGS (exact match required)
# - WEEX_ACCOUNT_TYPE=demo or test (REQUIRED - system refuses to start if missing or "live")
#
# WEEX_ACCOUNT_TYPE: Explicit account type declaration (REQUIRED for competition mode)
#   demo = Demo/paper trading account (allows competition mode)
#   test = Test/sandbox account (allows competition mode, treated same as demo)
#   live = Live/real money account (blocks competition mode at startup)
#   If not set when COMPETITION_MODE=true, system will FAIL at startup
#
# ⚠️ SAFETY DEFAULTS: DRY_RUN=true prevents real trades. WEEX_ACCOUNT_TYPE is
# commented out to force you to explicitly choose. Before setting DRY_RUN=false,
# you MUST uncomment and set WEEX_ACCOUNT_TYPE to match your actual account type.
#
# For PRODUCTION (real money):
COMPETITION_MODE=false
# COMPETITION_MODE_ACK=
# WEEX_ACCOUNT_TYPE=live  # Uncomment and set to "live" ONLY for real money accounts
#
# For COMPETITION (demo money) - uncomment and set ALL THREE:
# COMPETITION_MODE=true
# COMPETITION_MODE_ACK=I_ACCEPT_DEMO_ONLY_HIGH_RISK_AGGRESSIVE_SETTINGS
# WEEX_ACCOUNT_TYPE=demo  # or "test" for test/sandbox accounts

STARTING_BALANCE=1000
CYCLE_INTERVAL_MS=300000

# MIN_BALANCE_TO_TRADE: Minimum account balance required to open new trades.
# Recommended: 20-30% of STARTING_BALANCE to preserve capital for recovery.
# Values below 10% of STARTING_BALANCE will trigger a warning at startup.
MIN_BALANCE_TO_TRADE=200

# MIN_CONFIDENCE_TO_TRADE: Minimum AI confidence score (0-100) to execute a trade
# This value is NOT auto-overridden by COMPETITION_MODE - set manually based on your strategy.
# Suggested values:
#   Production: 50 (quality over quantity)
#   Competition: 45-50 (slightly more opportunities while maintaining quality)
MIN_CONFIDENCE_TO_TRADE=50

# MAX_DAILY_TRADES: Maximum trades per day (prevents overtrading)
# This value is NOT auto-overridden by COMPETITION_MODE - set manually based on your strategy.
# Default: 20 (conservative production value)
# When COMPETITION_MODE=true: Consider increasing to 50-60 for more opportunities
MAX_DAILY_TRADES=20

# DRY_RUN: Safety switch for live trading
#   true  = Simulation mode - NO real trades executed (safe for testing)
#   false = Live trading mode - REAL trades will be placed on WEEX
# WARNING: Set to false ONLY when you are ready to trade with real funds!
DRY_RUN=true

# =============================================================================
# RISK MANAGEMENT
# =============================================================================
# These are PRODUCTION defaults. When COMPETITION_MODE=true, the system
# automatically applies more aggressive values at runtime via riskLimits.ts:
#   - MAX_SAFE_LEVERAGE: 10 (production) → 17 (competition)
#   - MAX_POSITION_SIZE_PERCENT: 25% (production) → 50% (competition)
#   - STOP_LOSS_BY_LEVERAGE: Tighter stops at higher leverage
#
# The following env vars are NOT auto-overridden - set them manually:
#   - MIN_CONFIDENCE_TO_TRADE, MAX_DAILY_TRADES (see above)
#   - MAX_CONCURRENT_POSITIONS, MAX_SAME_DIRECTION_POSITIONS (below)
#   - WEEKLY_DRAWDOWN_LIMIT_PERCENT (below)
#
# Position limits (set manually for your mode)
MAX_CONCURRENT_POSITIONS=3      # Suggested competition: 4
MAX_SAME_DIRECTION_POSITIONS=2  # Suggested competition: 3

# Drawdown limit (set manually for your mode)
WEEKLY_DRAWDOWN_LIMIT_PERCENT=25  # Suggested competition: 30-35

# =============================================================================
# ANTI-CHURN RULES
# =============================================================================
# These values are NOT auto-overridden by COMPETITION_MODE - set manually.
# Suggested values for competition mode are shown in comments.
#
# Max trades per symbol per hour
MAX_TRADES_PER_SYMBOL_PER_HOUR=3  # Suggested competition: 4-5

# Cooldown after any trade
COOLDOWN_AFTER_TRADE_MS=900000    # 15 min production, suggested competition: 180000-300000 (3-5 min)

# Cooldown before flipping direction on same symbol
COOLDOWN_BEFORE_FLIP_MS=600000    # 10 min production, suggested competition: 240000-300000 (4-5 min)

# =============================================================================
# SENTIMENT & NEWS APIs
# =============================================================================
# NewsData.io: News source with built-in sentiment analysis
# Free tier: 200 credits/day, 30 credits per 15 minutes
# Get key at: https://newsdata.io/register
NEWSDATA_API_KEY=your_newsdata_api_key

# Note: Alternative.me Fear & Greed Index is FREE and doesn't require a key

# =============================================================================
# CORS
# =============================================================================
CORS_ORIGINS=http://localhost:25655,http://localhost:3000

# =============================================================================
# ADMIN ENDPOINTS
# =============================================================================
# Enable admin endpoints for cache clearing and testing
# Set to true ONLY in development/testing environments
# In production, leave disabled or restrict to internal network
AUTONOMOUS_ADMIN_ENABLED=false

# Optional admin token for remote access (if set, X-Admin-Token header is required)
# Generate a secure random token: openssl rand -hex 32
# AUTONOMOUS_ADMIN_TOKEN=your_secure_random_token_here

# =============================================================================
# REDDIT SENTIMENT (v5.2.0) - FREE, no API key needed
# =============================================================================
# Enable/disable Reddit sentiment fetching
# Set to false by default to avoid unexpected behavior; set to true to enable
REDDIT_SENTIMENT_ENABLED=false

# User-Agent for Reddit requests (required by Reddit)
# If not set, defaults to "HypothesisArena/{version} (trading bot, respectful scraping)"
# where {version} is automatically read from package.json at runtime
# REDDIT_USER_AGENT=MyCustomBot/1.0 (optional custom user agent)

# =============================================================================
# ADVANCED CONFIGURATION (optional - defaults are recommended)
# =============================================================================
# Technical indicator cache TTL (milliseconds)
# INDICATOR_CACHE_TTL_MS=60000

# Anti-churn hysteresis multiplier (1.0-3.0, default 1.2 = 20% more confidence to close)
# HYSTERESIS_MULTIPLIER=1.2

# Funding periods per day (default 3 for WEEX 8-hour funding)
# FUNDING_PERIODS_PER_DAY=3

# Max retries for failed operations
# MAX_RETRIES=3

# Debug WEEX API calls (development only)
# DEBUG_WEEX=false

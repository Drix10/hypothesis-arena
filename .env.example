# ===========================================
# Hypothesis Arena - Configuration
# ===========================================

# Server
NODE_ENV=development
PORT=25655
LOG_LEVEL=info

# ===========================================
# Database
# ===========================================
# Local SQLite (used by Prisma CLI for schema management)
DATABASE_URL="file:./dev.db"

# Turso (used in production runtime)
TURSO_DATABASE_URL="libsql://your-database.turso.io"
TURSO_AUTH_TOKEN="your_turso_auth_token_here"

# ===========================================
# WEEX API (Live Trading)
# ===========================================
# Get credentials from: https://www.weex.com/api
WEEX_API_KEY=
WEEX_SECRET_KEY=
WEEX_PASSPHRASE=
WEEX_BASE_URL=https://api-contract.weex.com
WEEX_WS_URL=wss://ws-contract.weex.com/v2/ws

# ===========================================
# AI Services
# ===========================================
# AI Provider: gemini or openrouter (default: gemini)
AI_PROVIDER=gemini

# Google Gemini API - Get key from: https://aistudio.google.com/apikey
GEMINI_API_KEY=
GEMINI_MODEL=gemini-2.5-flash

# OpenRouter API - Get key from: https://openrouter.ai/keys
OPENROUTER_API_KEY=

# OpenRouter Model (default: deepseek/deepseek-chat-v3.1)
# Other options: anthropic/claude-3.5-sonnet, qwen/qwen-2.5-72b-instruct, google/gemini-2.0-flash-exp:free
OPENROUTER_MODEL=deepseek/deepseek-chat-v3.1

# AI Configuration
AI_MAX_OUTPUT_TOKENS=8192
AI_DEBATE_MAX_TOKENS=8192
AI_SPECIALIST_MAX_TOKENS=8192
AI_MAX_PROMPT_LINES=250
AI_TEMPERATURE=0.8
AI_REQUEST_TIMEOUT_MS=60000
AI_MAX_RETRIES=3
AI_ANALYSIS_TIMEOUT_MS=90000
AI_MAX_TIMEOUT_MS=300000

# ===========================================
# Trading Configuration
# ===========================================
# Starting balance for P&L tracking (your initial deposit in USDT)
STARTING_BALANCE=1000
MAX_POSITION_SIZE=0.2
MAX_TOTAL_INVESTED=0.8
MAX_DAILY_TRADES=20
DRAWDOWN_PAUSE_THRESHOLD=0.3
DRAWDOWN_LIQUIDATE_THRESHOLD=0.8
MAX_LEVERAGE=5

# ===========================================
# Autonomous Trading Engine
# ===========================================
# SCALPING OPTIMIZED - Fast cycles, more positions
CYCLE_INTERVAL_MS=300000             # 5 min cycles (scalping needs speed)
MIN_TRADE_INTERVAL_MS=180000         # 3 min cooldown between trades
DEBATE_FREQUENCY=2                   # Debates every 2 cycles
MAX_POSITION_SIZE_PERCENT=20         # 20% per position (smaller = more positions)
MIN_BALANCE_TO_TRADE=30
DEFAULT_LEVERAGE=5                   # 5x leverage (safe max)
# Stop loss tolerance (4-5% recommended for 5x leverage)
STOP_LOSS_PERCENT=4
TAKE_PROFIT_PERCENT=8
MIN_CONFIDENCE_TO_TRADE=60
MIN_CONSENSUS_TO_TRADE=2
MAX_RETRIES=3
DRY_RUN=false

# Risk Management Limits
# NOTE: All *_PERCENT values use INTEGER percentages (e.g., 40 = 40%, not 0.40)
MAX_CONCURRENT_POSITIONS=6           # 6 positions for scalping diversification
MAX_SAME_DIRECTION_POSITIONS=4       # 4 same direction allowed
MAX_RISK_PER_TRADE_PERCENT=2         # Max account % risked per single trade
MAX_CONCURRENT_RISK_PERCENT=10       # Max total account % at risk (2% × 5 positions = 10%)
NET_EXPOSURE_LONG_PERCENT=60         # Max net LONG exposure as % of portfolio (margin used, not notional). Conservative: 40-50%, Aggressive: 60-80%. With 5x leverage, 60% margin = 300% notional.
NET_EXPOSURE_SHORT_PERCENT=50        # Max net SHORT exposure as % of portfolio (margin used, not notional). Conservative: 30-40%, Aggressive: 50-70%. Typically lower than LONG due to unlimited downside risk.
WEEKLY_DRAWDOWN_LIMIT_PERCENT=10     # Max portfolio drawdown per week before reducing risk (5-20). Conservative: 5-10%, Aggressive: 15-20%. Triggers position size reduction.
MAX_SECTOR_POSITIONS=3               # Max positions in same sector (e.g., L1s, memes). Conservative: 2, Aggressive: 3-4.

# Funding Rate Limits (in BASIS POINTS - 1 bp = 0.01%)
# WEEX funding rates are typically 1-10 basis points per 8h period
# Examples: 5 = 0.05%, 10 = 0.10%, 1 = 0.01%
MAX_FUNDING_AGAINST_BPS=5            # Max funding rate against position per 8h (basis points). 5 bps = 0.05%. Conservative: 3-5, Aggressive: 8-10.
FUNDING_WARN_THRESHOLD_BPS=1         # Funding rate warning threshold (basis points). 1 bp = 0.01%.

# Circuit Breakers
ENABLE_CIRCUIT_BREAKERS=true
CIRCUIT_BREAKER_CHECK_INTERVAL_MS=60000
CIRCUIT_BREAKER_CACHE_DURATION_MS=60000

# ===========================================
# Debate Configuration (AI Judge System v3.3.0)
# ===========================================
# The AI Judge evaluates debate arguments using a 4-criteria scoring rubric.
# Weights must sum to 100. Configure to prioritize different aspects.
DEBATE_TURNS_PER_ANALYST=2           # Turns per analyst (4 analysts × 2 = 8 turns total)
DEBATE_WEIGHT_DATA=25                # Scoring weight for data quality (0-100, must sum to 100)
DEBATE_WEIGHT_LOGIC=25               # Scoring weight for logic (0-100)
DEBATE_WEIGHT_RISK=25                # Scoring weight for risk awareness (0-100)
DEBATE_WEIGHT_CATALYST=25            # Scoring weight for catalyst clarity (0-100)
DEBATE_MIN_ARGUMENT_LENGTH=100       # Minimum argument length in characters
DEBATE_TURN_DELAY_MS=300             # Delay between turns to avoid rate limiting
DEBATE_WEIGHT_CONCENTRATION_THRESHOLD_PCT=70  # Warn if any single weight exceeds this %

# Per-Analyst Stop Loss Overrides (optional)
# STOP_LOSS_TECHNICAL=4
# STOP_LOSS_MACRO=5
# STOP_LOSS_RISK=4
# STOP_LOSS_QUANT=5

# ===========================================
# Compliance
# ===========================================
REQUIRE_AI_LOGS=true

# ===========================================
# Trading Style Configuration (Fallback Values)
# ===========================================
# These are FALLBACK values used when AI provides invalid targets.
# AI uses its own regime-adaptive tables - these don't force AI behavior.
TRADING_STYLE=scalp

# Scalping Fallbacks
SCALP_TARGET_PROFIT_PERCENT=5
SCALP_STOP_LOSS_PERCENT=5
SCALP_MAX_HOLD_HOURS=12
SCALP_TP_THRESHOLD_1=2
SCALP_TP_THRESHOLD_2=3
SCALP_TP_THRESHOLD_3=4
SCALP_TP_THRESHOLD_4=5
SCALP_MIN_RR_RATIO=1.5

# Swing Fallbacks
SWING_TARGET_PROFIT_PERCENT=10
SWING_STOP_LOSS_PERCENT=6
SWING_MAX_HOLD_HOURS=48
SWING_TP_THRESHOLD_1=3
SWING_TP_THRESHOLD_2=5
SWING_TP_THRESHOLD_3=8
SWING_TP_THRESHOLD_4=10
SWING_MIN_RR_RATIO=2

# ===========================================
# CORS
# ===========================================
CORS_ORIGINS=http://localhost:25655,http://localhost:3000
